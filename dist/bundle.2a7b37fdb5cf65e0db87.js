!function(){"use strict";var t={91:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},694:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMathFunctions=function(t){return{isDegree:!0,acos:function(e){return t.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(t,e){return t+e},asin:function(e){return t.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return t.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(t){return Math.log(t+Math.sqrt(t*t-1))},asinh:function(t){return Math.log(t+Math.sqrt(t*t+1))},atanh:function(t){return Math.log((1+t)/(1-t))},C:function(e,s){var i=1,o=e-s,n=s;n<o&&(n=o,o=s);for(var r=n+1;r<=e;r++)i*=r;var l=t.math.fact(o);return"NaN"===l?"NaN":i/l},changeSign:function(t){return-t},cos:function(e){return t.math.isDegree&&(e=t.math.toRadian(e)),Math.cos(e)},cosh:function(t){return(Math.pow(Math.E,t)+Math.pow(Math.E,-1*t))/2},div:function(t,e){return t/e},fact:function(t){if(t%1!=0)return"NaN";for(var e=1,s=2;s<=t;s++)e*=s;return e},inverse:function(t){return 1/t},log:function(t){return Math.log(t)/Math.log(10)},mod:function(t,e){return t%e},mul:function(t,e){return t*e},P:function(t,e){for(var s=1,i=Math.floor(t)-Math.floor(e)+1;i<=Math.floor(t);i++)s*=i;return s},Pi:function(e,s,i){for(var o=1,n=e;n<=s;n++)o*=Number(t.postfixEval(i,{n:n}));return o},pow10x:function(t){for(var e=1;t--;)e*=10;return e},sigma:function(e,s,i){for(var o=0,n=e;n<=s;n++)o+=Number(t.postfixEval(i,{n:n}));return o},sin:function(e){return t.math.isDegree&&(e=t.math.toRadian(e)),Math.sin(e)},sinh:function(t){return(Math.pow(Math.E,t)-Math.pow(Math.E,-1*t))/2},sub:function(t,e){return t-e},tan:function(e){return t.math.isDegree&&(e=t.math.toRadian(e)),Math.tan(e)},tanh:function(e){return t.math.sinh(e)/t.math.cosh(e)},toRadian:function(t){return t*Math.PI/180},and:function(t,e){return t&e}}}},189:function(t,e,s){var i=s(314),o=s(339),n=s(894),r=s(879),l=s(694),a=function(){function t(){this.toPostfix=n.toPostfix,this.addToken=i.addToken,this.lex=i.lex,this.postfixEval=r.postfixEval,this.math=l.createMathFunctions(this),this.tokens=o.createTokens(this)}return t.prototype.eval=function(t,e,s){return this.postfixEval(this.toPostfix(this.lex(t,e)),s)},t}();a.TOKEN_TYPES=o.tokenTypes,a.tokenTypes=o.tokenTypes,t.exports=a},314:function(t,e,s){Object.defineProperty(e,"__esModule",{value:!0});var i=s(339);function o(t,e){for(var s=0;s<t.length;s++)t[s]+=e;return t}var n={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0},r={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0},l={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0},a={},c={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0},h={1:!0},u=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function d(t,e,s,i){for(var o=0;o<i;o++)if(t[s+o]!==e[o])return!1;return!0}function m(t,e){for(var s=0;s<e.length;s++)if(e[s].token===t)return s;return-1}e.addToken=function(t){for(var e=0;e<t.length;e++){var s=t[e].token.length,o=-1;t[e].type===i.tokenTypes.FUNCTION_WITH_N_ARGS&&void 0===t[e].numberOfArguments&&(t[e].numberOfArguments=2),u[s]=u[s]||[];for(var n=0;n<u[s].length;n++)if(t[e].token===u[s][n]){o=m(u[s][n],this.tokens);break}-1===o?(this.tokens.push(t[e]),t[e].precedence=i.preced[t[e].type],u.length<=t[e].token.length&&(u[t[e].token.length]=[]),u[t[e].token.length].push(t[e].token)):(this.tokens[o]=t[e],t[e].precedence=i.preced[t[e].type])}},e.lex=function(t,e){var s,i={value:this.math.changeSign,type:0,precedence:1,show:"-"},p={value:")",show:")",type:5,precedence:0},f={value:"(",type:4,precedence:0,show:"("},v=[f],b=[],g=t,y=n,w=0,S=a,C="";void 0!==e&&this.addToken(e);var E=function(t,e){for(var s,i,o,n=[],r=e.length,l=0;l<r;l++)if(!(l<r-1&&" "===e[l]&&" "===e[l+1])){for(s="",i=e.length-l>u.length-2?u.length-1:e.length-l;i>0;i--)if(void 0!==u[i])for(o=0;o<u[i].length;o++)d(e,u[i][o],l,i)&&(s=u[i][o],o=u[i].length,i=0);if(l+=s.length-1,""===s)throw new Error("Can't understand after "+e.slice(l));n.push(t.tokens[m(s,t.tokens)])}return n}(this,g);for(s=0;s<E.length;s++){var _=E[s];if(14!==_.type){var T,x=_.token,R=_.type,A=_.value,N=_.precedence,P=_.show,k=v[v.length-1];for(T=b.length;T--&&0===b[T];)if(-1!==[0,2,3,4,5,9,10,11,12,13].indexOf(R)){if(!0!==y[R])throw new Error(x+" is not allowed after "+C);v.push(p),y=r,S=c,b.pop()}if(!0!==y[R])throw new Error(x+" is not allowed after "+C);!0===S[R]&&(R=2,A=this.math.mul,P="&times;",N=3,s-=1);var O={value:A,type:R,precedence:N,show:P,numberOfArguments:_.numberOfArguments};if(0===R)y=n,S=a,o(b,2),v.push(O),4!==E[s+1].type&&(v.push(f),b.push(2));else if(1===R)1===k.type?(k.value+=A,o(b,1)):v.push(O),y=r,S=l;else if(2===R)y=n,S=a,o(b,2),v.push(O);else if(3===R)v.push(O),y=r,S=c;else if(4===R)o(b,1),w++,y=n,S=a,v.push(O);else if(5===R){if(!w)throw new Error("Closing parenthesis are more than opening one, wait What!!!");w--,y=r,S=c,v.push(O),o(b,1)}else if(6===R){if(k.hasDec)throw new Error("Two decimals are not allowed in one number");1!==k.type&&(k={show:"0",value:0,type:1,precedence:0},v.push(k)),y=h,o(b,1),S=a,k.value+=A,k.hasDec=!0}else 7===R&&(y=r,S=c,o(b,1),v.push(O));8===R?(y=n,S=a,o(b,_.numberOfArguments+2),v.push(O),4!==E[s+1].type&&(v.push(f),b.push(_.numberOfArguments+2))):9===R?(9===k.type?k.value===this.math.add?(k.value=A,k.show=P,o(b,1)):k.value===this.math.sub&&"-"===P&&(k.value=this.math.add,k.show="+",o(b,1)):5!==k.type&&7!==k.type&&1!==k.type&&3!==k.type&&13!==k.type?"-"===x&&(y=n,S=a,o(b,2).push(2),v.push(i),v.push(f)):(v.push(O),o(b,2)),y=n,S=a):10===R?(y=n,S=a,o(b,2),v.push(O)):11===R?(y=n,S=a,v.push(O)):12===R?(y=n,S=a,o(b,6),v.push(O),4!==E[s+1].type&&(v.push(f),b.push(6))):13===R&&(y=r,S=c,v.push(O)),o(b,-1),C=x}else if(s>0&&s<E.length-1&&1===E[s+1].type&&(1===E[s-1].type||6===E[s-1].type))throw new Error("Unexpected Space")}for(T=b.length;T--;)v.push(p);if(!0!==y[5])throw new Error("complete the expression");for(;w--;)v.push(p);return v.push(p),v}},894:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.toPostfix=function(t){for(var e,s,i,o=[],n=-1,r=-1,l=[{value:"(",type:4,precedence:0,show:"("}],a=1;a<t.length;a++)if(1===t[a].type||3===t[a].type||13===t[a].type)1===t[a].type&&(t[a].value=Number(t[a].value)),o.push(t[a]);else if(4===t[a].type)l.push(t[a]);else if(5===t[a].type)for(;4!==(null==(c=s=l.pop())?void 0:c.type);){var c;s&&o.push(s)}else if(11===t[a].type){for(;4!==(null==(h=s=l.pop())?void 0:h.type);){var h;s&&o.push(s)}l.push(s)}else{r=(e=t[a]).precedence,n=(i=l[l.length-1]).precedence;var u="Math.pow"==i.value&&"Math.pow"==e.value;if(r>n)l.push(e);else{for(;n>=r&&!u||u&&r<n;)s=l.pop(),i=l[l.length-1],s&&o.push(s),n=i.precedence,u="Math.pow"==e.value&&"Math.pow"==i.value;l.push(e)}}return o}},879:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.postfixEval=function(t,e){(e=e||{}).PI=Math.PI,e.E=Math.E;for(var s,i,o,n=[],r=void 0!==e.n,l=0;l<t.length;l++)if(1===t[l].type)n.push({value:t[l].value,type:1});else if(3===t[l].type)n.push({value:e[t[l].value],type:1});else if(0===t[l].type){var a=n[n.length-1];Array.isArray(a)?a.push(t[l]):a.value=t[l].value(a.value)}else if(7===t[l].type){var c=n[n.length-1];Array.isArray(c)?c.push(t[l]):c.value=t[l].value(c.value)}else if(8===t[l].type){for(var h=[],u=0;u<t[l].numberOfArguments;u++){var d=n.pop();d&&h.push(d.value)}n.push({type:1,value:t[l].value.apply(t[l],h.reverse())})}else if(10===t[l].type)s=n.pop(),i=n.pop(),Array.isArray(i)?((i=i.concat(s)).push(t[l]),n.push(i)):Array.isArray(s)?(s.unshift(i),s.push(t[l]),n.push(s)):n.push({type:1,value:t[l].value(i.value,s.value)});else if(2===t[l].type||9===t[l].type)s=n.pop(),i=n.pop(),Array.isArray(i)?((i=i.concat(s)).push(t[l]),n.push(i)):Array.isArray(s)?(s.unshift(i),s.push(t[l]),n.push(s)):n.push({type:1,value:t[l].value(i.value,s.value)});else if(12===t[l].type){var m;s=n.pop(),m=!Array.isArray(s)&&s?[s]:s||[],i=n.pop(),o=n.pop(),n.push({type:1,value:t[l].value(o.value,i.value,m)})}else 13===t[l].type&&(r?n.push({value:e[t[l].value],type:3}):n.push([t[l]]));if(n.length>1)throw new Error("Uncaught Syntax error");return parseFloat(n[0].value.toFixed(15))}},339:function(t,e){function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},s.apply(this,arguments)}Object.defineProperty(e,"__esModule",{value:!0});var i,o={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1};e.tokenTypes=void 0,(i=e.tokenTypes||(e.tokenTypes={}))[i.FUNCTION_WITH_ONE_ARG=0]="FUNCTION_WITH_ONE_ARG",i[i.NUMBER=1]="NUMBER",i[i.BINARY_OPERATOR_HIGH_PRECENDENCE=2]="BINARY_OPERATOR_HIGH_PRECENDENCE",i[i.CONSTANT=3]="CONSTANT",i[i.OPENING_PARENTHESIS=4]="OPENING_PARENTHESIS",i[i.CLOSING_PARENTHESIS=5]="CLOSING_PARENTHESIS",i[i.DECIMAL=6]="DECIMAL",i[i.POSTFIX_FUNCTION_WITH_ONE_ARG=7]="POSTFIX_FUNCTION_WITH_ONE_ARG",i[i.FUNCTION_WITH_N_ARGS=8]="FUNCTION_WITH_N_ARGS",i[i.BINARY_OPERATOR_LOW_PRECENDENCE=9]="BINARY_OPERATOR_LOW_PRECENDENCE",i[i.BINARY_OPERATOR_PERMUTATION=10]="BINARY_OPERATOR_PERMUTATION",i[i.COMMA=11]="COMMA",i[i.EVALUATED_FUNCTION=12]="EVALUATED_FUNCTION",i[i.EVALUATED_FUNCTION_PARAMETER=13]="EVALUATED_FUNCTION_PARAMETER",i[i.SPACE=14]="SPACE",e.createTokens=function(t){return[{token:"sin",show:"sin",type:0,value:t.math.sin},{token:"cos",show:"cos",type:0,value:t.math.cos},{token:"tan",show:"tan",type:0,value:t.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:t.math.P},{token:"C",show:"C",type:10,value:t.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:t.math.asin},{token:"acos",show:"acos",type:0,value:t.math.acos},{token:"atan",show:"atan",type:0,value:t.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:t.math.cosh},{token:"acosh",show:"acosh",type:0,value:t.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:t.math.div},{token:"!",show:"!",type:7,value:t.math.fact},{token:"tanh",show:"tanh",type:0,value:t.math.tanh},{token:"atanh",show:"atanh",type:0,value:t.math.atanh},{token:"Mod",show:" Mod ",type:2,value:t.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:t.math.mul},{token:"sinh",show:"sinh",type:0,value:t.math.sinh},{token:"asinh",show:"asinh",type:0,value:t.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:t.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:t.math.add},{token:"-",show:"-",type:9,value:t.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:t.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:t.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:t.math.and}].map((function(t){return s({},t,{precedence:o[t.type]})}))},e.preced=o},606:function(t,e,s){t.exports=s.p+"assets/favicon.ico"}},e={};function s(i){var o=e[i];if(void 0!==o)return o.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}s.m=t,s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t}(),s.b=document.baseURI||self.location.href,function(){var t=s(91),e=s.n(t),i=new URL(s(606),s.b);e()(i);class o{constructor(t){if("string"==typeof t){const e=document.querySelector(t);if(!e)return{};this.elem=e}else{if(n.check(t))return t;this.elem=t}}html(t){return"string"!=typeof t?this.elem.innerHTML:(this.elem.innerHTML=t,this)}text(t){return"string"!=typeof t?this.elem.textContent:(this.elem.textContent=t,this)}append(t){const e=t instanceof o?t.elem:t;return this.elem.append(e),this}after(t){const e=t instanceof o?t.elem:t;return this.elem.after(e),this}before(t){const e=t instanceof o?t.elem:t;return this.elem.before(e),this}on(t,e){return this.elem.addEventListener(t,e),this}off(t,e){return this.elem.removeEventListener(t,e),this}addClass(t){return this.hasClass(t)||this.elem.classList.add(t),this}delClass(t){return this.hasClass(t)&&this.elem.classList.remove(t),this}hasClass(t){return this.elem.classList.contains(t)}closest(t){return n(this.elem.closest(t))}selectAll(t){return this.elem.querySelectorAll(t)}select(t){return n(this.elem.querySelector(t))}css(t){return t&&("string"==typeof t?this.elem.style.cssText=t:"object"==typeof t&&Object.keys(t).forEach((e=>this.elem.style[e]=t[e]))),0===arguments.length?this.elem.style.cssText:this}remove(){return this.elem.remove(),this}focus(){return this.elem.focus(),this}blur(){return this.elem.blur(),this}scrollTo(){return this.elem.scrollTo(...arguments),this}scrollBy(){return this.elem.scrollBy(...arguments),this}insertHTML(){return this.elem.insertAdjacentHTML(...arguments),this}clone(){return n(this.elem.cloneNode(...arguments))}replaceWith(){return this.elem.replaceWith(...arguments)}get parentNode(){return n(this.elem.parentNode)}get parentElem(){return n(this.elem.parentElement)}get nodeValue(){return this.elem.nodeValue}get childs(){return this.elem.childNodes}get prev(){return this.elem.previousSibling}get next(){return this.elem.nextSibling}get prevElem(){return n(this.elem.previousElementSibling)}get nextElem(){return n(this.elem.nextElementSibling)}set hidden(t){this.elem.hidden=t}get hidden(){return this.elem.hidden}set tabIndex(t){this.elem.tabIndex=t}get fChild(){return this.elem.firstChild}get lChild(){return this.elem.lastChild}get fElChild(){return n(this.elem.firstElementChild)}get lElChild(){return n(this.elem.lastElementChild)}get data(){return this.elem.dataset}get tag(){return this.elem.tagName}get children(){return this.elem.children}get cHeight(){return this.elem.clientHeight}get cWidth(){return this.elem.clientWidth}get oHeight(){return this.elem.offsetHeight}get oWidth(){return this.elem.offsetWidth}get sHeight(){return this.elem.scrollHeight}get sWidth(){return this.elem.scrollWidth}get style(){return this.elem.style}get scrollX(){return this.elem.scrollLeft}get scrollY(){return this.elem.scrollTop}get top(){return this.elem.getBoundingClientRect().top}get bottom(){return this.elem.getBoundingClientRect().bottom}get left(){return this.elem.getBoundingClientRect().left}get right(){return this.elem.getBoundingClientRect().right}}function n(t){if(null==t)return;const e=new o(t);return 0!==Object.keys(e).length?e:void 0}function r(){const t=n.create("div").css({height:"200px",width:"100px",position:"fixed",top:0,left:"-150px",overflow:"scroll"});document.body.append(t.elem);const e=t.oWidth-t.cWidth;return t.remove(),e}function l(){var t;t=`${r()}px`,document.documentElement.style.setProperty("--scrollbar-width",t)}function a(t){const e=Object.getPrototypeOf(t);Object.getOwnPropertyNames(e).forEach((e=>{"constructor"!==e&&"function"==typeof t[e]&&(t[e]=t[e].bind(t))}))}function c(t){const[e,s]=t.data.cellId.split(":");return{col:+e,row:+s}}function h(t,e){const[s,i]=t>e?[e,t]:[t,e];return new Array(i-s+1).fill("").map(((t,e)=>s+e))}function u(){return[...new Array(26).fill("").map(((t,e)=>`Key${String.fromCharCode(65+e)}`)),...new Array(10).fill("").map(((t,e)=>`Digit${e}`)),"Backquote","Minus","Equal","Backslash","BracketLeft","BracketRight","Semicolon","Quote","Slash","Period","Comma","NumpadDivide","NumpadMultiply","NumpadSubtract","NumpadAdd"]}function d(t){const[e,s]=t.data.cellId.split(":");return`${String.fromCharCode(+e+65)}${+s+1}`}function m(t,e){return JSON.stringify(t)===JSON.stringify(e)}function p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?(localStorage.setItem(t,JSON.stringify(e)),!0):JSON.parse(localStorage.getItem(t))}function f(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.replace(/<.+?>/g,(t=>{const s=t.replace(/<|>|\//g,"").split(" ")[0];return e.includes(s)?t:`&lt;${t.slice(1,-1)}&gt;`}))}function v(t){return JSON.parse(JSON.stringify(t))}function b(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}n.create=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=document.createElement(t);return e&&(s.className=e),n(s)},n.check=t=>t instanceof o,n.createText=t=>document.createTextNode(t);class g{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(b(this,"page",null),g.instance)return g.instance;if(g.instance=this,!t)throw new Error("Router selector is not provided");this.container=n(t),this.routes=e,this.repositoryRegEx=/.+(?=\/)/,this.repository=window.location.pathname.match(this.repositoryRegEx)||"",a(this),this.init()}get currentHash(){return window.location.hash.slice(1)}get currentPath(){let t=window.location.pathname;return t=t.replace(this.repositoryRegEx,""),t}init(){"loading"===document.readyState?window.addEventListener("load",this.onLoad):this.onLoad(),window.addEventListener("popstate",this.handleLocation),this.container.on("click",this.onClick)}destroy(){window.removeEventListener("load",this.onLoad),window.removeEventListener("popstate",this.handleLocation),this.container.off("click",this.onClick)}onLoad(){const t=localStorage.getItem("originalRoute");t&&(window.history.pushState({},"",t),localStorage.removeItem("originalRoute")),this.handleLocation()}onClick(t){const e=t.target.closest("a");e&&(t.preventDefault(),this.route(e.getAttribute("href")))}route(t){window.history.pushState({},"",`${this.repository}${t}`),this.handleLocation()}handleLocation(){this.page&&this.page.destroy(),this.container.html("");let t=this.routes[this.currentPath];t||(t=this.routes["/"],window.history.pushState({},"","/")),this.page=new t,this.container.append(this.page.getRoot()),this.page.afterRender()}}b(g,"instance",null);class y{getRoot(){throw new Error(`Method getRoot in ${this.constructor.name} is not implemented`)}afterRender(){}destroy(){}}class w{constructor(){var t,e,s;t=this,s=[],(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e="listeners"))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}emit(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];return!!this.listeners[t]&&(this.listeners[t].forEach((t=>t(...s))),!0)}subscribe(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),()=>{this.listeners[t]=this.listeners[t].filter((t=>t!==e))}}}function S(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class C{constructor(t){S(this,"prevState",{}),S(this,"unsub",null),this.store=t}subscribeComponents(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.prevState=this.store.getState(),this.unsub=this.store.subscribe((e=>{Object.keys(e).forEach((s=>{m(e[s],this.prevState[s])||t.forEach((t=>{if(t.isWatching(s)){const i={[s]:e[s]};t.storeChanged(i)}}))})),this.prevState=this.store.getState()}))}unsubscribe(){return!!this.unsub&&(this.unsub(),!0)}}const E="TABLE_RESIZE",_="TEXT_INPUT",T="SET_STYLES",x="CHANGE_TITLE",R="UPDATE_LAST_OPENED_TIMESTAMP";function A(t,e,s){return{type:E,data:{index:t,value:e,type:s}}}function N(t,e){return{type:_,data:{id:t,text:e}}}function P(t,e){return{type:T,data:{id:t,styles:e}}}function k(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class O{constructor(t,e){this.container=n(t),this.components=e.components||[],this.emitter=new w,this.store=e.store||{},this.storeSubscriber=new C(this.store)}getRoot(){const t=n.create("div",O.className),e=n.create("main",O.mainElemClassName),s={emitter:this.emitter,store:this.store};return this.components=this.components.map((i=>{const o=n.create(i.tagName,i.className),r=new i(o,s);return o.html(r.toHTML()),"header"===i.tagName?t.append(o):e.append(o),r})),t.append(e),t}init(){this.store.dispatch(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now().toString();return{type:R,data:{date:t}}}()),this.storeSubscriber.subscribeComponents(this.components),this.components.forEach((t=>t.init()))}destroy(){this.storeSubscriber.unsubscribe(),this.components.forEach((t=>t.destroy()))}}function M(t){return`on${e=t,e[0].toUpperCase()+e.slice(1)}`;var e}k(O,"className","document"),k(O,"mainElemClassName","document__main main-document");class I{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.root=t,this.listeners=e}initEventListeners(){this.listeners.forEach((t=>{const e=M(t);if(!this[e])throw new Error(`${e} method is not defined in ${this.name} component`);this[e]=this[e].bind(this),this.root.on(t,this[e])}))}removeEventListeners(){this.listeners.forEach((t=>{this.root.off(t,this[M(t)])}))}}class L extends I{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i,o;super(t,e.listeners),s=this,o=[],(i=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(i="unsubs"))in s?Object.defineProperty(s,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[i]=o,this.name=e.name||"",this.emitter=e.emitter,this.store=e.store,this.options=e.options,this.storeSubscribes=e.storeSubscribes||[],this.prepare()}toHTML(){return""}emit(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];this.emitter.emit(t,...s)}on(t,e){const s=this.emitter.subscribe(t,e);this.unsubs.push(s)}dispatch(t){this.store.dispatch(t)}isWatching(t){return this.storeSubscribes.includes(t)}prepare(){}storeChanged(){}init(){this.initEventListeners()}destroy(){this.removeEventListeners(),this.unsubs.forEach((t=>t()))}}function D(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class z extends L{constructor(t){super(t,{name:"Formula",listeners:["input","keydown"],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}})}get focused(){return!!window.document.activeElement.closest('[data-formula="input"]')}init(){super.init(),this.initHTMLElements(),a(this),this.on("cell:input",(t=>{this.focused||this.setInputText(t)})),this.on("cell:changed",(t=>{let{newCell:e}=t;return this.setInputText(e.data.content)})),this.on("table:select",this.updateChords)}initHTMLElements(){this.startChord=this.root.select('[data-formula="startChord"]'),this.endChord=this.root.select('[data-formula="endChord"]'),this.chordsDouble=this.root.select('[data-formula="chordsDouble"]'),this.input=this.root.select('[data-formula="input"]')}setInputText(t){this.input.html(t)}updateChords(t){let{start:e,end:s}=t;this.startChord.text(d(e)),this.endChord.text(d(s)),e.elem===s.elem?(this.endChord.elem.hidden=!0,this.chordsDouble.elem.hidden=!0):(this.endChord.elem.hidden=!1,this.chordsDouble.elem.hidden=!1)}toHTML(){return'\n\t\t<div class="document-formula__chords">\n\t\t\t<span class="document-formula__chords-start" data-formula="startChord"></span><span class="document-formula__chords-double" data-formula="chordsDouble">:</span><span class="document-formula__chords-end" data-formula="endChord"></span>\n\t\t</div>\n\t\t<div class="document-formula__fx">fx</div>\n\t\t<div class="document-formula__input" contenteditable="true" spellcheck="false" data-formula="input"></div>'}onInput(){this.emit("formula:input",this.input.text())}onKeydown(t){switch(t.code){case"Enter":case"Tab":t.preventDefault(),this.emit("formula:focus-cell")}}}D(z,"className","main-document__formula document-formula"),D(z,"tagName","section");class ${static saveDocument(t,e){p(this.getDocumentKey(t),e)}static removeDocument(t){localStorage.removeItem(this.getDocumentKey(t))}static getDocumentKey(t){return`excelDocument:${t}`}}function j(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class H extends L{constructor(t){super(t,{name:"Header",listeners:["input","keydown","click"],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}})}init(){super.init(),this.title=this.root.select('[data-type="title"]')}onClick(t){const e=n(t.target.closest("[data-button]"));if(!e)return;const s=new g;switch(e.data.button){case"delete":window.confirm(`Delete "${this.store.getState().title}" table?`)&&($.removeDocument(s.currentHash),s.route("/"));break;case"exit":s.route("/")}}onInput(t){var e;n(t.target).closest('[data-type="title"]')&&this.dispatch((e=this.title.text(),{type:x,data:{text:e}}))}onKeydown(t){const{code:e}=t;"Enter"!==e&&"Escape"!==e||t.target.blur()}toHTML(){const{title:t}=this.store.getState();return`\n\t\t<div class="header-document__container">\n\t\t\t<div class="header-document__input" contenteditable="true" spellcheck="false" data-type="title">${f(t)}</div>\n\t\t\t<div class="header-document__buttons">\n\t\t\t\t<button class="header-document__button button" data-button="delete">\n\t\t\t\t\t<i class="header-document__button-icon material-icons">delete</i>\n\t\t\t\t</button>\n\t\t\t\t<button class="header-document__button button" data-button="exit">\n\t\t\t\t\t<i class="header-document__button-icon material-icons">exit_to_app</i>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>`}}function W(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}j(H,"className","document__header header-document"),j(H,"tagName","header");let F=r();class B{constructor(t){W(this,"selectionActive",!1),W(this,"formulaSelected",[[]]),this.table=t}onPointerdown(t){t.target===this.selectionCircle.elem&&(t.preventDefault(),t.target.setPointerCapture(t.pointerId),F=r(),this.selectionActive=!0,[this.endCol,this.endRow]=this.table.selection.selected.at(-1).at(-1).data.cellId.split(":"),[this.startCol,this.startRow]=this.table.selection.selected[0][0].data.cellId.split(":"),this.addFormulaRect())}onPointermove(t){if(!this.selectionActive)return;const e=document.elementFromPoint(t.pageX,t.pageY);if(!e)return;const s=n(e).closest('[data-table="cell"]');s&&s.elem!==this.lastSelected?.elem&&(this.lastSelected=s,this.addFormulaRect(),this.setFormulaSelected()),this.table.scrollRows(t,F)}onPointerup(){this.selectionActive&&(this.selectionActive=!1,this.lastSelected=null,this.removeFormulaRect(),this.updateFormulaSelectedValues(),this.updateSelection(),this.addSelectionRect())}updateSelection(){let t=this.table.selection.selected.at(-1).at(-1),e=this.table.selection.selected[0][0];switch(this.formulaRectDirection){case"right":case"bottom":t=this.formulaSelected.at(-1).at(-1);break;case"top":case"left":e=this.formulaSelected[0][0]}this.table.selection.selectGroup(t,e)}updateFormulaSelectedValues(){const t=this.table.selection.selected,e=(t,e)=>{const s=e.data.cellId,i=t.data.content;e.html(t.html()),e.data.content=i,this.table.dispatch(N(s,i));const o=e.style.width;e.css(t.css()).css({width:""}),this.table.dispatch(P(s,function(t){const e={};return t.split(";").forEach((t=>{const[s,i]=t.split(":");var o;s&&(e[(o=s.trim(),o.replace(/-\w/g,(t=>`${t.slice(1).toUpperCase()}`)))]=i.trim())})),e}(e.css()))),e.css({width:o})};switch(this.formulaRectDirection){case"top":{let s=this.formulaSelected.length-1;for(;s>=0;)for(let i=t.length-1;i>=0;i-=1){if(s<0)return;for(let o=t[i].length-1;o>=0;o-=1){const n=this.formulaSelected[s][o];e(t[i][o],n)}s-=1}break}case"left":{const s=this.formulaSelected[0].length,i=t[0].length;let o=s-1;for(;o>=0;)for(let s=i-1;s>=0;s-=1){if(o<0)return;for(let i=t.length-1;i>=0;i-=1){const n=this.formulaSelected[i][o];e(t[i][s],n)}o-=1}break}case"right":{const s=this.formulaSelected[0].length,i=t[0].length;let o=0;for(let n=0;n<s;n+=1){o=n%i;for(let s=0;s<this.formulaSelected.length;s+=1){const i=this.formulaSelected[s][n];e(t[s][o],i)}}break}case"bottom":{let s=0;for(let i=0;i<this.formulaSelected.length;i+=1){s=i%t.length;for(let o=0;o<this.formulaSelected[i].length;o+=1){const n=this.formulaSelected[i][o];e(t[s][o],n)}}break}}}setFormulaSelected(){let t=this.startRow,e=this.startCol,s=this.endRow,i=this.endCol;switch(this.formulaRectDirection){case"none":return void(this.formulaSelected=[[]]);case"top":t=this.lastSelected.data.cellId.split(":")[1],s=+this.startRow-1;break;case"left":e=this.lastSelected.data.cellId.split(":")[0],i=+this.startCol-1;break;case"right":e=+this.endCol+1,i=this.lastSelected.data.cellId.split(":")[0];break;case"bottom":t=+this.endRow+1,s=this.lastSelected.data.cellId.split(":")[1]}const o=this.table.getCell(+e,+t),n=this.table.getCell(+i,+s);this.formulaSelected=this.table.getCells(o,n)}addFormulaRect(){if(this.removeFormulaRect(),this.formulaRect=n.create("div","formula-rect"),this.lastSelected){let t=0,e=0,s=0,i=0;const[o,r]=this.lastSelected.data.cellId.split(":"),l=this.startRow-r,a=r-this.endRow,c=this.startCol-o,h=o-this.endCol;switch(Math.max(l,h,a,c,0)){case 0:this.formulaRectDirection="none";break;case l:this.formulaRectDirection="top",t=n(this.table.rowsList.children[r]).top-this.table.header.bottom+this.table.body.scrollY,e=this.rectLeft,s=this.rectWidth,i=this.rectTop-t;break;case h:this.formulaRectDirection="right",t=this.rectTop,e=this.rectLeft+this.rectWidth,s=n(this.table.headersList.children[o]).right-this.table.rows.left+this.table.rows.scrollX-e,i=this.rectHeight;break;case a:this.formulaRectDirection="bottom",t=this.rectTop+this.rectHeight,e=this.rectLeft,s=this.rectWidth,i=n(this.table.rowsList.children[r]).bottom-this.table.header.bottom+this.table.body.scrollY-t;break;case c:this.formulaRectDirection="left",t=this.rectTop,e=n(this.table.headersList.children[o]).left-this.table.rows.left+this.table.rows.scrollX,s=this.rectLeft-e,i=this.rectHeight}this.formulaRect.css({top:t-1+"px",left:e-1+"px",width:`${s+1}px`,height:`${i+1}px`})}this.table.rows.append(this.formulaRect)}removeFormulaRect(){this.formulaRect&&this.formulaRect.remove()}addSelectionRect(t){this.removeSelectionRect(),this.selectionRect=n.create("div","selection-rect"),this.selectionCircle=n.create("div","selection-rect__circle");let e=this.table.selection.selected[0][0],s=this.table.selection.selected.at(-1).at(-1);t&&(e=t,s=t);const i=e.top-this.table.header.bottom+this.table.body.scrollY,o=e.left-this.table.rows.left+this.table.rows.scrollX,r=s.bottom-this.table.header.bottom+this.table.body.scrollY-i,l=s.right-this.table.rows.left+this.table.rows.scrollX-o;this.rectTop=i,this.rectLeft=o,this.rectWidth=l,this.rectHeight=r,this.selectionRect.css({top:i-1+"px",left:o-1+"px",height:`${r+1}px`,width:`${l+1}px`}),this.selectionRect.append(this.selectionCircle),this.table.rows.append(this.selectionRect)}removeSelectionRect(){this.selectionRect&&this.selectionRect.remove()}}var U=s(189),Y=s.n(U);class X{constructor(t){this.table=t}parse(t){if(!t?.startsWith("="))return t;const e=this.replaceCellIds(t.slice(1)),s=new(Y());try{return s.eval(e).toString()}catch{return"=Error!"}}replaceCellIds(t){const e=this.table.store.getState();return t.replace(/[A-Z]\d+/g,(t=>{const s=function(t){const e=t.slice(0,1),s=+t.slice(1)-1;return!!/[A-Z]/.test(e)&&`${e.charCodeAt()-65}:${s}`}(t);return this.parse(e.cellsState[s]?.data)}))}}function K(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function G(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,q(t,e,"get"))}function q(t,e,s){if(!e.has(t))throw new TypeError("attempted to "+s+" private field on non-instance");return e.get(t)}var V=new WeakMap;class J{constructor(t,e){var s,i,o;o={writable:!0,value:void 0},function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(s=this,i=V),i.set(s,o),K(this,"resizerTop",void 0),K(this,"resizerLeft",void 0),K(this,"topCompensation",void 0),K(this,"leftCompensation",void 0),this.table=t,this.minElemSize=e,this.resizerWidth=n('[data-resizer="col"]').oWidth,this.table.on("cell:changed",(t=>{let{oldCell:e,oldCellHeight:s}=t;if(!e)return;const i=e.data.cellId.split(":")[1];this.updateRowHeight(i,s)}))}get resizer(){return G(this,V)}set resizer(t){var e,s;G(this,V)&&G(this,V).delClass(J.activeClass),t&&t.addClass(J.activeClass),s=t,function(t,e,s){if(e.set)e.set.call(t,s);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=s}}(e=this,q(e,V,"set"),s)}get resizerType(){return G(this,V)?.data.resizer}onPointerdown(t){this.resizer=n(t.target).closest("[data-resizer]"),this.resizer&&(t.target.setPointerCapture(t.pointerId),this.initResizer(t))}onPointermove(t){this.resizer&&this.moveResizer(t)}onPointerup(){if(this.resizer){if("row"===this.resizerType){const t=this.resizer.bottom-this.resizable.top-Math.ceil(this.resizerWidth/2);this.updateRowHeight(this.getIndex(),t)}else if("col"===this.resizerType){const t=this.resizer.right-this.resizable.left-Math.ceil(this.resizerWidth/2);this.updateColumnWidth(this.getIndex(),t)}this.endResizer()}}updateChordsRange(){const t=r();this.X={max:this.table.root.cWidth-t-this.resizerWidth,min:this.resizable.left+this.minElemSize},this.Y={max:window.innerHeight-t-this.resizerWidth,min:this.resizable.top+this.minElemSize}}initResizer(t){this.resizable=this.resizer.closest("[data-resizable]"),this.updateChordsRange(),this.resizerTop=this.resizer.top,this.resizerLeft=this.resizer.left,this.topCompensation=t.clientY-this.resizerTop,this.leftCompensation=t.clientX-this.resizerLeft,this.setPositionFixed()}moveResizer(t){if("row"===this.resizerType){let e=t.clientY-this.topCompensation;e=Math.max(this.Y.min,e),e=Math.min(this.Y.max,e),requestAnimationFrame((()=>{this.resizer&&this.resizer.css({top:`${e}px`})}))}else if("col"===this.resizerType){let e=t.clientX-this.leftCompensation;e=Math.max(this.X.min,e),e=Math.min(this.X.max,e),requestAnimationFrame((()=>{this.resizer&&this.resizer.css({left:`${e}px`})}))}}endResizer(){this.removePositionFixed(),this.resizer=null,this.resizerTop=0,this.resizerLeft=0}setPositionFixed(){this.resizer.css({top:`${this.resizerTop}px`,left:`${this.resizerLeft}px`,position:"fixed"})}removePositionFixed(){this.resizer.css({top:"",left:"",position:""})}getIndex(){let t;return"row"===this.resizerType?t=Array.from(this.table.indexesList.children).indexOf(this.resizable.elem):"col"===this.resizerType&&(t=Array.from(this.table.headersList.children).indexOf(this.resizable.elem)),t}updateColumnWidth(t,e){n(this.table.headersList.children[t]).css({width:`${e}px`}),Array.from(this.table.rowsList.children).map((e=>n(e).select('[data-table-role="cells-list"]').children[t])).forEach((t=>n(t).css({width:`${e}px`}))),this.table.formulaSelection.addSelectionRect(),this.table.dispatch(A(t,e,"col"))}updateRowHeight(t,e){const s=n(this.table.indexesList.children[t]),i=n(this.table.rowsList.children[t]);s.oHeight!==e&&(s.css({height:`${e}px`}),i.css({height:`${e}px`}),this.table.formulaSelection.addSelectionRect(),this.table.dispatch(A(t,e,"row")))}}K(J,"activeClass","active");class Z{constructor(t){this.table=t,a(this),this.init()}init(){this.table.body.on("scroll",this.updateTableRowsHeight),this.table.rows.on("scroll",this.updateTableColumnsScroll),window.addEventListener("resize",this.updateTableRowsHeight),l(),window.addEventListener("resize",l)}updateTableRowsHeight(){requestAnimationFrame((()=>{const t=this.table.root.cHeight-this.table.header.cHeight;this.table.rows.css({height:`${t+this.table.body.scrollY}px`})}))}updateTableColumnsScroll(){requestAnimationFrame((()=>{this.table.header.css({marginLeft:`-${this.table.rows.scrollX}px`})}))}}function Q(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class tt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;Q(this,"charCodes",{A:65,Z:90}),Q(this,"colsCount",this.charCodes.Z-this.charCodes.A+1),this.table=t,this.state=t.store.getState(),this.rowsCount=e,a(this),this.html=this.createTable()}getColumn(t,e){const s=this.state.colsState[e];return`<li class="document-table__column" data-resizable style="${s?`width: ${s}px;`:""}">${this.getColLetter(e)}\n\t\t\t<div class="document-table__resizer document-table__resizer_column" data-resizer="col"></div>\n\t\t</li>`}getHeader(){let t='<ul class="document-table__header" data-table="header" data-table-role="headers-list">';return t+=new Array(this.colsCount).fill("").map(this.getColumn).join(""),`${t}</ul>`}getInfo(t,e){const s=this.state.rowsState[e];return`<li class="document-table__info-row"  data-resizable style="${s?`height: ${s}px;`:""}">${e+1}\n\t\t\t<div class="document-table__resizer document-table__resizer_row" data-resizer="row"></div>\n\t\t</li>`}getInfoColumn(){let t='<ul class="document-table__info-column" data-table="info" data-table-role="indexes-list">';return t+=new Array(this.rowsCount).fill("").map(this.getInfo).join(""),`${t}</ul>`}getCell(t,e){const s=`${t}:${e}`;let i=this.state.cellsState[s]?.data||"";i=i?f(i,tt.allowedCellTags):"";let o=this.state.cellsState[s]?.styles;o=o?function(t){return Object.keys(t).map((e=>{return`${s=e,s.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}: ${t[e]};`;var s})).join(" ")}(o):"";const n=this.state.colsState[t];return`<li class="document-table__cell" contenteditable="true" data-table="cell" data-cell-id="${s}" data-content='${i}' style="${n?`width: ${n}px;`:""} ${o}">${this.table.mathParser.parse(i)}</li>`}getCells(t){let e='<ul class="document-table__row-cells" data-table-role="cells-list">';return e+=new Array(this.colsCount).fill("").map(((e,s)=>this.getCell(s,t))).join(""),`${e}</ul>`}getRow(t){const e=this.state.rowsState[t];return`<li class="document-table__row" style="${e?`height: ${e}px;`:""}">${this.getCells(t)}</li>`}getRows(){let t='<div class="document-table__rows" data-table="rows">\n\t\t\t<ul class="document-table__rows-list" data-table-role="rows-list">';return t+=new Array(this.rowsCount).fill("").map(((t,e)=>this.getRow(e))).join(""),`${t}</ul></div>`}getBody(){let t='<div class="document-table__body" data-table="body">';return t+=this.getInfoColumn(this.rowsCount),t+=this.getRows(this.rowsCount),`${t}</div>`}createTable(){let t='<div class="document-table__info-row document-table__info-row_empty"></div>';return t+=this.getHeader(),t+=this.getBody(this.rowsCount),t}getColLetter(t){return String.fromCharCode(this.charCodes.A+t)}}function et(t,e,s){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,s)}function st(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function it(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,nt(t,e,"get"))}function ot(t,e,s){return function(t,e,s){if(e.set)e.set.call(t,s);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=s}}(t,nt(t,e,"set"),s),s}function nt(t,e,s){if(!e.has(t))throw new TypeError("attempted to "+s+" private field on non-instance");return e.get(t)}Q(tt,"allowedCellTags",["span","br"]);let rt=r();var lt=new WeakMap,at=new WeakMap;class ct{constructor(t){et(this,lt,{writable:!0,value:void 0}),st(this,"isFormulaMode",!1),st(this,"selectionActive",!1),et(this,at,{writable:!0,value:[[]]}),this.table=t,this.selectionObserver=new MutationObserver(this.observeSelection.bind(this)),this.selectionObserver.observe(t.root.elem,{subtree:!0,attributes:!0,attributeFilter:["class"]}),this.active=this.table.root.select('[data-cell-id="0:0"]')}set selected(t){t[0][0]&&this.table.emit("table:select",{start:t[0][0],end:t.at(-1).at(-1)}),ot(this,at,t)}get selected(){return it(this,at)}set active(t){t.elem!==it(this,lt)?.elem&&(it(this,lt)&&(it(this,lt).delClass(ct.activeClass),this.activeObserver.disconnect(),this.setCellHTML(it(this,lt),this.table.mathParser.parse(it(this,lt).data.content))),this.table.emit("cell:changed",{newCell:t,oldCell:it(this,lt),oldCellHeight:it(this,lt)?.oHeight}),window.getSelection().removeAllRanges(),this.table.root.focus(),this.clearSelected(),this.selected=[[t]],this.lastSelected=t,ot(this,lt,t.addClass(ct.activeClass)),this.table.formulaSelection?.addSelectionRect(t),this.activeObserver=new MutationObserver((()=>{const e=f(t.html(),tt.allowedCellTags);this.isFormulaMode=e.startsWith("="),this.table.emit("cell:input",e),t.data.content=e,this.table.dispatch(N(t.data.cellId,e))})),this.activeObserver.observe(t.elem,{childList:!0,subtree:!0,characterData:!0}))}get active(){return it(this,lt)}get cellFocused(){return!!document.activeElement.closest('[data-table="cell"]')}onPointerdown(t){const e=n(t.target).closest('[data-table="cell"]');e?this.cellFocused&&this.active.elem===e.elem||(this.table.formulaSelection.removeSelectionRect(),t.preventDefault(),t.target.setPointerCapture(t.pointerId),t.shiftKey?this.selectGroup(e):this.active=e,rt=r(),this.selectionActive=!0):this.table.root.focus()}onPointermove(t){if(!this.selectionActive)return;this.table.formulaSelection.removeSelectionRect();const e=document.elementFromPoint(t.pageX,t.pageY);if(!e)return;const s=n(e).closest('[data-table="cell"]');s&&s.elem!==this.lastSelected?.elem&&this.selectGroup(s),this.table.scrollRows(t,rt)}onPointerup(){this.selectionActive&&this.table.formulaSelection.addSelectionRect(),this.selectionActive=!1}onDblclick(){this.focusActiveCell()}onKeydown(t){if(!ct.navigationKeys.includes(t.code))return;let{col:e,row:s}=c(this.active);if(this.cellFocused)switch(t.code){case"Enter":if(t.preventDefault(),t.ctrlKey){const t=window.getSelection(),e=t.anchorOffset,s=n.create("br").elem;let i,o,r=!1;const l=t.anchorNode;if(l instanceof Text){const t=l.nodeValue,n=l.parentElement,a=new DocumentFragment;a.append(t.slice(0,e)),a.append(s);const c=t.slice(e);l.nextSibling?(a.append(c||""),r=!0):a.append(c||s.cloneNode()),n.replaceChild(a,l),c?(i=s.nextSibling,o=0):(i=n,o=Array.from(i.childNodes).indexOf(s)+1,o=r?o+1:o)}else{const t=l.childNodes[e];t?(t.after(s),o=e+1):(l.append(s.cloneNode()),l.append(s),o=2),i=l}const a=document.createRange();return a.setStart(i,o),a.collapse(!0),t.removeAllRanges(),void t.addRange(a)}t.shiftKey?s-=1:s+=1;break;case"Escape":return t.preventDefault(),this.clearCell(this.active),this.table.root.focus(),void this.table.formulaSelection.addSelectionRect()}else{if(u().includes(t.code))return this.clearCell(this.active),this.focusActiveCell(),this.clearSelected(),this.selected=[[this.active]],void(this.lastSelected=this.active);switch(t.code){case"ArrowUp":t.preventDefault(),s-=1;break;case"ArrowDown":t.preventDefault(),s+=1;break;case"ArrowLeft":t.preventDefault(),e-=1;break;case"ArrowRight":t.preventDefault(),e+=1;break;case"Enter":return t.preventDefault(),void this.focusActiveCell();case"Delete":case"Backspace":return t.preventDefault(),void this.selected.forEach((t=>t.forEach((t=>{this.clearCell(t),this.table.dispatch(N(t.data.cellId,""))}))))}}"Tab"===t.code&&(t.preventDefault(),t.shiftKey?e-=1:e+=1),e=Math.max(0,e),e=Math.min(this.table.template.colsCount-1,e),s=Math.max(0,s),s=Math.min(this.table.template.rowsCount-1,s);const i=this.table.root.select(`[data-cell-id="${e}:${s}"]`);i.elem!==this.active.elem&&(this.scrollToCell(i),this.active=i)}focusActiveCell(){this.clearSelected(),this.table.formulaSelection.removeSelectionRect(),this.setCellHTML(this.active,this.active.data.content);const t=function(t){const e=n(t);let s;for(let t=e.childs.length-1;t>=0;t-=1){if(s=e.childs[t],s instanceof Text)return s;const i=n(e.childs[t]);for(let t=i.childs.length-1;t>=0;t-=1)if(s=i.childs[t],s instanceof Text)return s}return null}(this.active);if(t){const e=document.createRange(),s=window.getSelection();e.setStart(t,t.nodeValue.length),e.collapse(!0),s.removeAllRanges(),s.addRange(e)}else this.active.focus()}setCellHTML(t,e){t.html(f(e,tt.allowedCellTags))}scrollToCell(t){const e=t.left-this.table.info.oWidth+this.table.rows.scrollX,s=e+t.oWidth,i=t.top-this.table.body.top+this.table.body.scrollY,o=i+t.oHeight;rt=r();const n=this.table.root.oHeight-this.table.header.oHeight-rt,l=this.table.root.oWidth-this.table.info.oWidth-rt;this.table.body.scrollY>i?this.table.body.scrollTo({top:i}):this.table.body.scrollY+n<o&&this.table.body.scrollTo({top:o-n}),this.table.rows.scrollX>e?this.table.rows.scrollTo({left:e}):this.table.rows.scrollX+l<s&&this.table.rows.scrollTo({left:s-l})}selectGroup(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.active;t&&(this.clearSelected(),this.lastSelected=t,this.selected=this.table.getCells(e,t),this.selected.forEach((t=>t.forEach((t=>t.addClass(ct.selectedClass))))),1===this.selected.length&&1===this.selected[0].length&&this.active.delClass(ct.selectedClass))}clearSelected(){this.selected.forEach((t=>t.forEach((t=>t.delClass(ct.selectedClass))))),this.selected=[[this.active]],this.lastSelected=this.active}clearCell(t){t.data.content="",t.html("")}observeSelection(t){t.forEach((t=>{const e=n(t.target).closest('[data-table="cell"]');if(!e)return;const{col:s,row:i}=c(e),o=n(this.table.headersList.children[s]),r=n(this.table.indexesList.children[i]);e.hasClass(ct.selectedClass)||e.hasClass(ct.activeClass)?(o.addClass(ct.selectedClass),r.addClass(ct.selectedClass)):e.hasClass(ct.selectedClass)||e.hasClass(ct.activeClass)||(o.delClass(ct.selectedClass),r.delClass(ct.selectedClass))}))}}function ht(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}st(ct,"activeClass","active"),st(ct,"selectedClass","selected"),st(ct,"navigationKeys",["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Enter","Delete","Escape","Backspace",...u()]);class ut extends L{constructor(t){super(t,{name:"Table",listeners:["pointerdown","pointerup","pointermove","dblclick","keydown"],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}})}prepare(){this.mathParser=new X(this),this.template=new tt(this,30)}init(){super.init(),this.initHTMLElements(),this.scroll=new Z(this),this.resizer=new J(this,7),this.selection=new ct(this),this.formulaSelection=new B(this),this.formulaSelection.addSelectionRect(),this.on("formula:input",(t=>{this.selection.active.text(t),this.dispatch(N(this.selection.active.data.cellId,this.selection.active.text()))})),this.on("formula:focus-cell",(()=>this.selection.focusActiveCell())),this.on("toolbar:changeStyles",this.updateStyles.bind(this))}initHTMLElements(){this.header=this.root.select('[data-table="header"]'),this.info=this.root.select('[data-table="info"]'),this.rows=this.root.select('[data-table="rows"]'),this.body=this.root.select('[data-table="body"]'),this.headersList=this.root.select('[data-table-role="headers-list"]'),this.rowsList=this.root.select('[data-table-role="rows-list"]'),this.indexesList=this.root.select('[data-table-role="indexes-list"]'),this.root.tabIndex=0}toHTML(){return this.template.html}onPointerdown(t){this.resizer.onPointerdown(t),this.selection.onPointerdown(t),this.formulaSelection.onPointerdown(t)}onPointermove(t){this.resizer.onPointermove(t),this.selection.onPointermove(t),this.formulaSelection.onPointermove(t)}onPointerup(t){this.resizer.onPointerup(t),this.selection.onPointerup(t),this.formulaSelection.onPointerup(t)}onDblclick(t){this.selection.onDblclick(t)}onKeydown(t){this.selection.onKeydown(t)}getCells(t,e){const s=[],i=h(c(t).col,c(e).col);return h(c(t).row,c(e).row).forEach((t=>{const e=[];i.forEach((s=>{const i=this.getCell(s,t);e.push(i)})),s.push(e)})),s}getCell(t,e){const s=n(this.rowsList.children[e]);return n(s.select('[data-table-role="cells-list"]').children[t])}scrollRows(t,e){const s=this.root.oWidth-e,i=this.root.oHeight+this.root.top-e,o=this.info.oWidth,n=this.root.top+this.header.oHeight;t.pageX>=s?this.rows.scrollBy({left:5}):t.pageX<=o&&this.rows.scrollBy({left:-5}),t.pageY>=i?this.body.scrollBy({top:5}):t.pageY<=n&&this.body.scrollBy({top:-5})}updateStyles(t){const e=window.getSelection();if("None"===e.type)this.selection.selected.forEach((e=>e.forEach((e=>{e.css(t),this.dispatch(P(e.data.cellId,t))})))),this.root.focus();else try{const{active:s}=this.selection;if(console.log(e.anchorNode===s.elem),e.anchorNode===e.focusNode){console.log("same");const i=n(e.anchorNode),{anchorOffset:o,focusOffset:r}=e,l=i.parentElem;let a=document.createRange();if(l.elem===s.elem){if(i.elem instanceof Text){console.log("not wrapped"),a=e.getRangeAt(0);const s=n.create("span");a.surroundContents(s.elem),s.css(t),o===r&&s.html("&nbsp;"),a.selectNodeContents(s.elem)}else if(o===r){console.log("not text node");const s=o;a.selectNodeContents(i.elem),a.setStart(i.elem,s);const r=a.extractContents();a.selectNodeContents(i.elem),a.setEnd(i.elem,s);const l=a.extractContents(),c=n.create("span").append(r).css(i.css()),h=n.create("span").html("&nbsp").css(i.css()).css(t);i.html("").append(l).after(h),c.html()&&h.after(c),i.html()||i.remove(),this.selection.active.focus(),a.selectNodeContents(h.elem),e.removeAllRanges(),e.addRange(a)}else{console.log("full wrapper");const e=i.clone(!0);e.css(t),i.replaceWith(e.elem),a.selectNodeContents(e.elem)}this.selection.active.focus(),e.removeAllRanges(),e.addRange(a)}else if(i.elem===s.elem){console.log("active node");const s=n.create("span").html("&nbsp;").css(t);a=e.getRangeAt(0),a.insertNode(s.elem),a.selectNodeContents(s.elem),this.selection.active.focus(),e.removeAllRanges(),e.addRange(a)}else{console.log("wrapped");const[s,o]=e.anchorOffset>e.focusOffset?[e.focusOffset,e.anchorOffset]:[e.anchorOffset,e.focusOffset],r=i.nodeValue.slice(s,o);a.selectNodeContents(l.elem),a.setStart(i.elem,o);const c=a.extractContents();a.selectNodeContents(l.elem),a.setEnd(i.elem,s);const h=a.extractContents(),u=n.create("span").append(c).css(l.css()),d=n.create("span").append(r).css(l.css()).css(t);l.html("").append(h).after(d),u.html()&&d.after(u),l.html()||l.remove(),this.selection.active.focus(),s===o&&(d.html("&nbsp;"),a.setStart(d.elem,1),a.collapse(!0)),a.selectNodeContents(d.elem),e.removeAllRanges(),e.addRange(a)}}else{console.log("not same");let i=!1;const o=n(e.anchorNode),r=n(e.focusNode),l=o.parentElem.elem===s.elem?o:o.parentElem,a=r.parentElem.elem===s.elem?r:r.parentElem;let c=mt(l,s),h=mt(a,s);c===h&&(i=!0,c=mt(o,l),h=mt(r,l));const[u,d,m,p]=c>h?[r,e.focusOffset,o,e.anchorOffset]:[o,e.anchorOffset,r,e.focusOffset],f=u.parentElem,v=m.parentElem,b=u.parentElem,g=dt(u,d,"end"),y=dt(m,p,"start");this.selection.active.focus();const w=document.createRange();if(i){console.log("in one span");const e=y,s=g,i=b.css();e.css(i).css(t),s.css(i),b.text()||b.remove(),s.text()||s.remove(),w.selectNodeContents(e.elem)}else{!function(t,e){const s=document.createRange();let i=t;for(;i.elem!==e.elem;){let{nextElem:t}=i;for(s.setStartAfter(i.elem);"BR"===t?.tag&&t.nextElem&&t.nextElem.elem!==e.elem;)t=t.nextElem;if(s.setEndBefore(t.elem),s.startOffset!==s.endOffset){const t=n.create("span");s.surroundContents(t.elem)}i=t}}(g,y),f.elem!==s.elem&&(g.css(f.css()),f.text()||f.remove()),v.elem!==s.elem&&(y.css(v.css()),v.text()||v.remove());const e=Array.from(s.children);e.slice(e.indexOf(g.elem),e.indexOf(y.elem)+1).forEach((e=>{const s=n(e);"SPAN"===s.tag&&s.css(t)})),w.selectNodeContents(y.lChild),w.setStart(g.fChild,0)}e.removeAllRanges(),e.addRange(w)}}catch{console.warn("UpdateStylesError")}}}function dt(t,e,s){const i=document.createRange(),o="SPAN"===t.tag?t:t.parentElem;"SPAN"===o.tag?i.selectNodeContents(o.elem):i.selectNode(t.elem),"end"===s?i.setStart(t.elem,e):"start"===s&&i.setEnd(t.elem,e);const r=i.extractContents(),l=n.create("span").append(r);return"SPAN"===o.tag?"start"===s?o.before(l.elem):"end"===s&&o.after(l.elem):"start"===s?t.replaceWith(l.elem,t.elem):"end"===s&&t.replaceWith(t.elem,l.elem),l}function mt(t,e){return Array.from(e.childs).indexOf(t.elem)}ht(ut,"className","main-document__table document-table"),ht(ut,"tagName","section");class pt extends L{get stateTemplate(){return"stateTemplate is not overrided"}initState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state={...t}}setState(t){t&&(this.state={...this.state,...t},this.root.html(this.stateTemplate))}}var ft={textAlign:"left",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"};class vt{constructor(t){this.toolbar=t,a(this)}getButton(t){return`\n\t\t<li class="toolbar-buttons-block__button-wrapper">\n\t\t\t<button class="toolbar-buttons-block__button button ${t.active?"active":""}" data-type="button" data-value='${JSON.stringify(t.value)}'>\n\t\t\t\t<i class="toolbar-buttons-block__button-icon material-icons">${t.icon}</i>\n\t\t\t</button>\n\t\t</li>`}getButtonsBlock(t){let e='<li class="document-toolbar__buttons-block toolbar-buttons-block"><ul class="toolbar-buttons-block__buttons">';return e+=t.map(this.getButton).join(""),`${e}</ul></li>`}createToolbar(){this.buttons=this.getButtons();let t='<ul class="document-toolbar__container">';return t+=Object.values(this.buttons).map(this.getButtonsBlock).join(""),`${t}</ul>`}getButtons(){const{state:t}=this.toolbar;return{textStyle:[{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?ft.fontWeight:"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?ft.fontStyle:"italic"}},{icon:"format_underlined",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?ft.textDecoration:"underline"}}],textAlign:[{icon:"format_align_left",active:"left"===t.textAlign,value:{textAlign:"left"}},{icon:"format_align_center",active:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",active:"right"===t.textAlign,value:{textAlign:"right"}}]}}}function bt(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class gt extends pt{constructor(t){super(t,{name:"Toolbar",listeners:["click"],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}})}init(){super.init(),this.on("cell:changed",this.updateState.bind(this))}prepare(){this.initState(ft),this.template=new vt(this)}get stateTemplate(){return this.template.createToolbar()}toHTML(){return this.stateTemplate}onClick(t){const e=n(t.target).closest('[data-type="button"]');if(!e)return;const s=JSON.parse(e.data.value);this.setState(s),this.emit("toolbar:changeStyles",s)}updateState(t){let{newCell:e}=t;const s={...ft,...this.store.getState().cellsState[e.data.cellId]?.styles};this.setState(s)}}bt(gt,"className","main-document__toolbar document-toolbar"),bt(gt,"tagName","section");const yt={title:"New table",colsState:{},rowsState:{},cellsState:{}};function wt(t){return t||v(yt)}function St(t,e){switch(e.type){case E:{const s=`${e.data.type}sState`,i={...t[s],[e.data.index]:e.data.value};return{...t,[s]:i}}case _:{const s={...t.cellsState[e.data.id],data:e.data.text};s.data||delete s.data;const i=Ct(e.data.id,s,t);return{...t,cellsState:i}}case T:{const s={...t.cellsState[e.data.id]?.styles,...e.data.styles},i={...t.cellsState[e.data.id],styles:s};(function(t){let e=!0;return Object.keys(t).forEach((s=>{t[s]!==ft[s]&&(e=!1)})),e})(i.styles)&&delete i.styles;const o=Ct(e.data.id,i,t);return{...t,cellsState:o}}case x:return{...t,title:e.data.text};case R:return{...t,lastOpenedTimestamp:e.data.date};default:return t}}function Ct(t,e,s){let i;return Object.getOwnPropertyNames(e).length?i={...s.cellsState,[t]:e}:(i={...s.cellsState},delete i[t]),i}new g("#app",{"/":class extends y{getDocumentsHTML(){let t="";for(let e=0;e<localStorage.length;e+=1){const s=localStorage.key(e);s.startsWith("excelDocument:")&&(t+=this.getDocumentHTML(s))}return t}getDocumentHTML(t){const e=t.split(":")[1],s=p(t),i=new Date(+s.lastOpenedTimestamp),o=i.getDate(),n=i.getMonth(),r=i.getFullYear(),l=new Date,a=window.navigator.language||window.navigator.userLanguage,c=l.getDate()===o&&l.getMonth()===n&&l.getFullYear()===r?i.toLocaleTimeString(a,{hour:"numeric",minute:"numeric"}):i.toLocaleDateString(a,{year:"numeric",day:"numeric",month:"short"});return`\n\t\t<li class="home-documents-section__document">\n\t\t\t<a href="/excel#${e}" class="home-documents-section__document-link">\n\t\t\t\t<div class="home-documents-section__document-title">${s.title}</div>\n\t\t\t\t<time class="home-documents-section__document-date" datetime="${r}-${n+1}-${o}">${c}</time>\n\t\t\t</a>\n\t\t</li>`}getRoot(){const t=Date.now().toString();return n.create("div","home").html(`\n\t\t<header class="home__header header-home">\n\t\t\t<div class="header-home__container">\n\t\t\t\t<h1 class="header-home__title">Excel Dashboard</h1>\n\t\t\t</div>\n\t\t</header>\n\t\t<main class="home__main main-home">\n\t\t\t<section class="main-home__buttons-section home-buttons-section">\n\t\t\t\t<div class="home-buttons-section__container">\n\t\t\t\t\t<a href="/excel#${t}" class="home-buttons-section__button">+</a>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<section class="main-home__documents-section home-documents-section">\n\t\t\t\t<div class="home-documents-section__container">\n\t\t\t\t\t<header class="home-documents-section__header">\n\t\t\t\t\t\t<div class="home-documents-section__title">Title</div>\n\t\t\t\t\t\t<div class="home-documents-section__date">Last opened</div>\n\t\t\t\t\t</header>\n\t\t\t\t\t<ul class="home-documents-section__documents">\n\t\t\t\t\t\t${this.getDocumentsHTML()}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</main>`)}},"/excel":class extends y{getRoot(){let t=(new g).currentHash;t||(t=Date.now().toString(),window.location.hash=t),this.documentId=t,this.storageKey=$.getDocumentKey(this.documentId);const e=wt(p(this.storageKey));return this.store=function(t){let e=t({...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},{type:"__INIT__"}),s=[];return{dispatch(i){e=t(e,i),s.forEach((t=>t(v(e))))},subscribe(t){return s.includes(t)||s.push(t),()=>s=s.filter((e=>e!==t))},getState(){return v(e)}}}(St,e),this.storeUnsub=this.store.subscribe((t=>{$.saveDocument(this.documentId,t)})),this.excel=new O("#app",{components:[H,gt,z,ut],store:this.store}),this.excel.getRoot()}afterRender(){this.excel.init()}removeEmptyDocument(){const t=this.store.getState();delete t.lastOpenedTimestamp,m(t,wt())&&$.removeDocument(this.documentId)}destroy(){this.excel.destroy(),this.storeUnsub(),this.removeEmptyDocument()}}})}()}();